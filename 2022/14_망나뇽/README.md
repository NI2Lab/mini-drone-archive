
# 2022 ë¯¸ë‹ˆë“œë¡  ììœ¨ì£¼í–‰ ê²½ì§„ëŒ€íšŒ ë§ë‚˜ë‡½íŒ€ğŸ²


## âœ”ï¸ëŒ€íšŒ ì§„í–‰ ì „ëµ 
* **ë§ì˜ ì¤‘ì‹¬ ì°¾ê¸°**

![image](https://user-images.githubusercontent.com/93758371/178394444-e2c6f7db-ae30-46a8-9db3-93070a2aea6b.png)

> 1. ì¹´ë©”ë¼ ìº¡ì³í•œ í›„ ë§ ì´ì§„í™”   
> 2. ì´ì§„í™” ì˜ìƒì˜ ë§ì„ ì±„ìš°ê¸° ìœ„í•´ imfillí•¨ìˆ˜ ì‚¬ìš©
> 3. ë§ì„ ì±„ìš´ ì˜ìƒì— ì´ì§„í™” ì˜ìƒì„ ë¹¼ì„œ ë§ë§Œì„ ì¶”ì¶œ   
> 4. êµ¬ë©ì˜ ì¤‘ì‹¬ì„ ì°¾ì•„ Throttleì œì–´ì™€ Rollì œì–´ë¥¼ í•˜ì—¬ ë“œë¡ ê³¼ êµ¬ë©ì˜ ì¤‘ì‹¬ì´ ì¼ì¹˜í•˜ê²Œ ì œì–´   

   

* **êµ¬ë© ì°¾ê¸°**

![image](https://user-images.githubusercontent.com/93758371/178394729-dd38655e-ed23-4b55-813f-03e257af79c9.png)


> 1. ì¹´ë©”ë¼ ìº¡ì²˜ë¥¼ í†µí•œ ë§ ì´ì§„í™”
> 2. êµ¬ë©ì˜ ì¤‘ì‹¬ ì°¾ëŠ” ì½”ë“œ ì‚¬ìš©
> 3. êµ¬ë©ì´ êµ¬í•´ì§€ì§€ ì•Šìœ¼ë©´ ë§ì— ëŒ€í•œ ì¤‘ì‹¬ì„ í†µí•´ Throttleì œì–´ì™€ Rollì œì–´ ì‹¤í–‰
 
* **ë§ì´ ë³´ì´ì§€ ì•Šì„ ê²½ìš°**
 
 ![image](https://user-images.githubusercontent.com/93758371/178409083-d329a624-0a9b-479e-903c-a812b6823125.png)

> 1. ì¹´ë©”ë¼ ìº¡ì²˜ë¥¼ í†µí•œ ë§ ì´ì§„í™”
> 2. í”½ì…€ì´ ë³´ì´ì§€ ì•Šì„ ë•Œ, Rollì œì–´ë¥¼ í†µí•œ ë§ íƒìƒ‰
> 3. ê·¸ëŸ¼ì—ë„ ë³´ì´ì§€ ì•Šì„ ë•Œ, Throttleì œì–´ë¥¼ í†µí•œ ë§ íƒìƒ‰

* **ì „ì§„í•  ë•Œ**

![image](https://user-images.githubusercontent.com/93758371/178395700-dfa67d23-8208-4090-bb84-0cde0abcd73d.png)

> 1. ì¹´ë©”ë¼ ìº¡ì³ë¥¼ í†µí•œ í‘œì‹ ì´ì§„í™” 
> 2. í‘œì‹ìƒ‰ì˜ í”½ì…€ ë¯¸ê²€ì¶œì‹œ ì „ì§„í”½ì…€ ê²€ì¶œì‹œ í‘œì‹ì— ëŒ€í•œ ì¤‘ì  ì¶”ì¶œ
> 3. ì¤‘ì ê³¼ ë“œë¡ ì´ ì¼ì§ì„ ìƒì— ìˆìœ¼ë©´ ì „ì§„, ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ ì¼ì§ì„ ìƒì— ìœ„ì¹˜í•˜ê²Œ í•˜ê¸° ìœ„í•´ Roll ì œì–´
> 4. ê³¼ì • ë°˜ë³µ í›„ í”½ì…€ ê°’ì´ ê¸°ì¤€ ì´ìƒì´ ë˜ë©´ í‘œì‹ ë°œê²¬ìœ¼ë¡œ ì¸ì‹
> 5. íšŒì „ í˜¹ì€ ì°©ì§€


## âœ”ï¸ì•Œê³ ë¦¬ì¦˜ ì„¤ëª…

![image](https://user-images.githubusercontent.com/93758371/178422453-de833562-c8a5-4418-b617-76d6dce9ca1e.png)

![image](https://user-images.githubusercontent.com/93758371/178430144-de063fe7-3220-45f5-bdf4-65efde872c74.png)

**1. ë“œë¡  ì—°ê²° ë° ì´ë¥™**
   
> [ryze]í•¨ìˆ˜ì™€ [takeoff]í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ ë“œë¡  ì—°ê²° í›„ ì´ë¥™

**2. ì „ì²˜ë¦¬**

> ë“œë¡ ì˜ ì˜ìƒì„ ê°€ì ¸ì˜¤ê¸° ìœ„í•´ [snapshot]í•¨ìˆ˜ë¥¼ ì‚¬ìš©
> RGB ìƒ‰ ê³µê°„ì—ì„œ HSV ìƒ‰ ê³µê°„ìœ¼ë¡œ ë³€ê²½(íŒŒë€ìƒ‰, ë¹¨ê°„ìƒ‰, ì´ˆë¡ìƒ‰, ë³´ë¼ìƒ‰)   
> ë§ ë° í‘œì‹ì„ ì°¾ê¸° ìœ„í•´ ì´ì§„í™” ì‹¤í–‰   

**3. ë§ ì¤‘ì  ì¢Œí‘œ ê³„ì‚° ë° ë“œë¡  ìœ„ì¹˜ ì œì–´**

> ì¤‘ì  ì¢Œí‘œë¡œ ë“œë¡ ì˜ í˜„ì¬ ìœ„ì¹˜ íŒë‹¨
> ë§ì´ ì™¼ìª½ì— ìˆëŠ” ì§€ ì˜¤ë¥¸ìª½ì— ìˆëŠ”ì§€ íŒë‹¨í•˜ê¸° ìœ„í•´ ë°˜ìœ¼ë¡œ ë‚˜ëˆ„ì–´ ê°ê° í”½ì…€ìˆ˜ë¥¼ ë”í•´ ë§ì˜ ì¤‘ì•™ì— ë“œë¡ ì´ ìœ„ì¹˜í•˜ë„ë¡ ìƒí•˜ì¢Œìš° ì œì–´
> ì¤‘ì  ì¢Œí‘œ ì°¾ê¸°ìœ„í•´ [regionprops]í•¨ìˆ˜ë¥¼ ì‚¬ìš©

**4. ì§ì§„ ë° í‘œì‹ í™•ì¸**

> ë“œë¡ ì˜ ìœ„ì¹˜ê°€ ì¤‘ì•™ì— ìœ„ì¹˜í•œë‹¤ê³  íŒë‹¨ë˜ë©´ í‘œì‹ì„ ì¸ì‹í•  ìˆ˜ ìˆë„ë¡ Pitchì œì–´ë¥¼ í†µí•œ ì§ì§„


**5. í‘œì‹ê³¼ì˜ ê±°ë¦¬ íŒë‹¨**

> ì…ë ¥ ì˜ìƒì—ì„œ í‘œì‹ ìƒ‰ìƒì˜ í”½ì…€ ê°œìˆ˜ë¥¼ í†µí•´ í‘œì‹ê³¼ ë“œë¡ ê°„ì˜ ê±°ë¦¬ íŒë‹¨   
> ë§ í†µê³¼ ì „ í‘œì‹ì˜ ì¤‘ì ì„ ì¬íƒìƒ‰í•˜ê³  ê·¸ ì¤‘ì ì„ ê¸°ì¤€ìœ¼ë¡œ ë“œë¡ ì˜ ìƒí•˜ì¢Œìš° ì œì–´ í›„, ì§ì§„í•´ ë§ í†µê³¼


**6. íšŒì „ ë° ì°©ë¥™**

> ë§ í†µê³¼ í›„, í‘œì‹ ìƒ‰ì— ë§ì¶° ê°ê° íšŒì „ ë° ë“œë¡  ì°©ë¥™






## âœ”ï¸ì†ŒìŠ¤ ì½”ë“œ ì„¤ëª…

* **ë“œë¡  ë° ë³€ìˆ˜ ì„¤ì •**
```
clear;
clc;
drone=ryze();
cam=camera(drone);

idealX = 480;
idealY = 200;
past_red = 0;
current_red = 0;
move = 0;
a=0;
b=0;   
```

* **ë“œë¡  ì´ë¥™ ë° 1ë‹¨ê³„ ë†’ì´ ì„¤ì •**
```
takeoff(drone);
moveup(drone,'Distance', 0.3,'Speed',1);
moveforward(drone,'Distance', 0.8,'Speed',1);
```

* **1ë‹¨ê³„**
```
while 1
    frame =snapshot(cam);
    hsv = rgb2hsv(frame);
    h = hsv(:,:,1);
    s = hsv(:,:,2);
    binary_res = ((0.611<h)&(h<0.75))&((0.494<s)&(s<0.894));

    fillimg = imfill(binary_res,'holes');
    %ë§ ì°¾ìœ¼ë©´ íƒˆì¶œ
    if sum(fillimg,'all') > 30000
        break
    end
    if move == 0
        moveleft(drone,'Distance',0.5,'speed',1);
        move = 1;
    elseif move == 1
        moveleft(drone,'distance',0.5,'speed',1);
        move = 2;
    elseif move == 2
        movedown(drone,'distance',0.5,'Speed',1);
        move = 3;
    elseif move == 3
        moveright(drone,'Distance',0.5,'Speed',1);
        move = 0;
    end
end
%í‘œì‹ ë³´ì´ë©´ ì „ì§„
while 1
    frame =snapshot(cam);
    hsv = rgb2hsv(frame);
    h = hsv(:,:,1);
    s = hsv(:,:,2);
    binary_res_red = ((0.950<h)&(h<=1.000))&((0.700<s)&(s<=1.000))|((0.000<=h)&(h<0.05))&((0.700<s)&(s<=1.000));
    past_red = current_red;
    current_red = sum(binary_res_red,'all');
    
    if past_red > 0 & past_red - 500 > current_red 
        turn(drone, deg2rad(90));
        break
    end
    if sum(binary_res_red,'all') >= 2200
        turn(drone, deg2rad(90));
        break
    end
    

    moveforward(drone,'Distance', 0.5,'Speed',1);
```

* **2ë‹¨ê³„ ë³€ìˆ˜ ì¬ì„¤ì • ë° ìœ„ì¹˜ ì¡°ì •**
```
past_red = 0;
current_red = 0;
a=0;
b=0;
move = 0;

moveforward(drone,'Distance', 1.25,'Speed',1);
moveup(drone,'Distance', 0.2,'Speed',1);
moveright(drone,'Distance',1.5,'Speed',1);
```

* **3ë‹¨ê³„ ë³€ìˆ˜ ì¬ì„¤ì • ë° ì¡°ì •**
```
past_red = 0;
current_red = 0;
a=0;
b=0;
move = 0;

moveforward(drone,'Distance', 1,'Speed',1);
turn(drone, deg2rad(45));
```

* **ë§ì´ ì•ˆë³´ì¼ ë•Œ(ë§ì´ ë³´ì´ë©´ í†µê³¼)**
```
while 1
    frame =snapshot(cam);
    hsv = rgb2hsv(frame);
    h = hsv(:,:,1);
    s = hsv(:,:,2);
    binary_res = ((0.611<h)&(h<0.75))&((0.494<s)&(s<0.894));

    fillimg = imfill(binary_res,'holes');
    %ë§ ì°¾ìœ¼ë©´ íƒˆì¶œ
    if sum(fillimg,'all') > 30000
        break
    end
    if move == 0
        moveleft(drone,'Distance',2,'speed',1);
        move = 1;
    elseif move == 1
        moveleft(drone,'Distance',2,'speed',1);
        move = 2;
    elseif move == 2
        movedown(drone,'Distance',0.3,'Speed',1);
        move = 3;
    elseif move == 3
        moveright(drone,'Distance',4,'Speed',1);
        move = 0;
    end
end
```

* **ë§ì´ ë³´ì´ê±°ë‚˜ í‘œì‹ì´ ë³´ì´ë©´ í†µê³¼**
```
while 1
    frame =snapshot(cam);
    hsv = rgb2hsv(frame);
    h = hsv(:,:,1);
    s = hsv(:,:,2);
    v = hsv(:,:,3);
    binary_res = ((0.611<h)&(h<0.75))&((0.494<s)&(s<0.894));
    binary_res_red = ((0.222<h)&(h<0.506))&((0.172<s)&(s<0.816))&((0.118<v)&(v<0.580));
    stats = regionprops('table',binary_res_red,'Area');
    %í‘œì‹ì´ ë³´ì´ë©´ íƒˆì¶œ
    for i = 1:size(stats)
        if stats.Area(i)==max(stats.Area)
            maxI=i;
            break;
        end
    end
    
    try
    if stats.Area(maxI) > 300
        break
    end
    catch error
    end
    %ì´ë¯¸ì§€ ì±„ìš°ê¸°
    fillimg = imfill(binary_res,'holes');
    result = fillimg - binary_res;
    if sum(binary_res,'all')> 500000
        moveup(drone,'distance',0.3,'speed',1);
        moveback(drone,'distance',1,'speed',1);
    end
     %ì´ ë³´ì´ë©´ íƒˆì¶œ
    if sum(result,'all') > 20000
        break
    elseif sum(result,'all') < 20000
        stats = regionprops('table',binary_res,'Centroid','MajorAxisLength');
        for i = 1:size(stats)
            if stats.MajorAxisLength(i)==max(stats.MajorAxisLength)
                maxI=i;
                break;
            end
        end
        try
        centerX = max(stats.Centroid(maxI,1));
        centerY = max(stats.Centroid(maxI,2));
        
        if abs(idealX - centerX) < 40
            a=1;
        elseif idealX - centerX < 0
            a=0;
            moveright(drone,'distance',0.5,'Speed',1);
        elseif idealX - centerX > 0
            a=0;
            moveleft(drone,'distance',0.4,'Speed',1);
        end
        if abs(idealY - centerY) < 20
            b=1;
        elseif idealY - centerY < 0
            b=0;
            movedown(drone,'distance',0.3,'Speed',1);
        elseif idealY - centerY > 0
            b=0;
            moveup(drone,'distance',0.4,'Speed',1);
        end   
        catch error
            moveback(drone,'distance',0.5,'speed',1);
        end
        if a==1 && b==1
            break
        end
    end
end
```

* **ë§ì˜ ì¤‘ì‹¬ ê³„ì‚° í›„ ì œì–´**
```
while 1
    frame =snapshot(cam);
    hsv = rgb2hsv(frame);
    h = hsv(:,:,1);
    s = hsv(:,:,2);
    v = hsv(:,:,3);
    binary_res = ((0.611<h)&(h<0.75))&((0.494<s)&(s<0.894));
    binary_res_red = ((0.222<h)&(h<0.506))&((0.172<s)&(s<0.816))&((0.118<v)&(v<0.580));
    stats = regionprops('table',binary_res_red,'Area');
    
    %í‘œì‹ì´ ë³´ì´ë©´ íƒˆì¶œ
    for i = 1:size(stats)
        if stats.Area(i)==max(stats.Area)
            maxI=i;
            break;
        end
    end
    try
    if stats.Area(maxI) > 300
        break
    end
    catch error
    end

    fillimg = imfill(binary_res,'holes');
    result = fillimg - binary_res; 
    if sum(result,'all') < 20000
        moveback(drone,'distance',1,'speed',1);
        continue
    end
    stats = regionprops('table',result,'Centroid','MajorAxisLength','MinorAxisLength');
    for i = 1:size(stats)
        if stats.MajorAxisLength(i)==max(stats.MajorAxisLength)
            maxI=i;
            break;
        end
    end
    
    % ì±„ìš°ëŠ” ì½”ë“œ
    centerX = max(stats.Centroid(maxI,1));
    centerY = max(stats.Centroid(maxI,2));
    
    if abs(idealX - centerX) < 40
        a=1;
    elseif idealX - centerX < 0
        a=0;
        moveright(drone,'distance',0.3,'Speed',1);
    elseif idealX - centerX > 0
        a=0;
        moveleft(drone,'distance',0.2,'Speed',1);
    end
    if abs(idealY - centerY) < 20
        b=1;
    elseif idealY - centerY < 0
        b=0;
        movedown(drone,'distance',0.2,'Speed',1);
    elseif idealY - centerY > 0
        b=0;
        moveup(drone,'distance',0.3,'Speed',1);
    end
    
    if a==1 && b==1
        moveforward(drone,'distance',0.5,'speed',1);
        break
    end
end
```
* **ì „ì§„**
```
while 1
    frame =snapshot(cam);
    hsv = rgb2hsv(frame);
    h = hsv(:,:,1);
    s = hsv(:,:,2);
    v = hsv(:,:,3);
    binary_res_red = ((0.222<h)&(h<0.506))&((0.172<s)&(s<0.816))&((0.118<v)&(v<0.580));
    past_red = current_red;
    current_red = sum(binary_res_red,'all');
    
    if past_red > 0 & past_red - 500 > current_red 
        turn(drone, deg2rad(90));
        break
    end

    if sum(binary_res_red,'all') >= 2300
        turn(drone, deg2rad(90));
        break
    end
    if sum(binary_res_red,'all') > 100
        stats = regionprops('table',binary_res_red,'Centroid','MajorAxisLength','MinorAxisLength','Area');
        for i = 1:size(stats)
            if stats.MajorAxisLength(i)==max(stats.MajorAxisLength)
                maxI=i;
                break;
            end
        end
        if stats.Area(maxI) > 150
            centerX = max(stats.Centroid(maxI,1));
            centerY = max(stats.Centroid(maxI,2));
            if abs(idealX - centerX) < 50
                a=1;
            elseif idealX - centerX < 0
                a=0;
                moveright(drone,'distance',0.2,'Speed',1);
            elseif idealX - centerX > 0
                a=0;
                moveleft(drone,'distance',0.3,'Speed',1);
            end
            if abs(idealY - centerY) < 30
                b=1;
            elseif idealY - centerY < 0 && b == 0
                movedown(drone,'distance',0.2,'Speed',1);
            elseif idealY - centerY > 0 && b == 0
                moveup(drone,'distance',0.3,'Speed',1);
            end
            if a==0 || b == 0
                continue
            end
        end
    end
     moveforward(drone,'Distance', 0.6,'Speed',1);
end
```
